<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D å¤ªé˜³ç³»ï¼šæŠ˜å äº¤äº’ç‰ˆ</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; font-family: "Microsoft YaHei", "Rounded Mplus 1c", sans-serif; }
        
        #canvas-container { width: 100vw; height: 100vh; display: block; }

        /* --- é¢æ¿æ ·å¼ (åŒ…å«åŠ¨ç”»è¿‡æ¸¡) --- */
        .info-panel {
            position: fixed; 
            bottom: 20px; 
            left: 20px; 
            width: 380px; 
            max-width: 90vw;
            background: rgba(20, 25, 40, 0.92); 
            backdrop-filter: blur(15px);
            border-radius: 20px; 
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 25px; 
            box-shadow: 0 15px 50px rgba(0,0,0,0.8);
            color: white; 
            z-index: 100; 
            
            /* é«˜åº¦è¿‡æ¸¡åŠ¨ç”» */
            transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            max-height: 85vh; /* å±•å¼€æ—¶çš„æœ€å¤§é«˜åº¦ */
            overflow: hidden; /* é˜²æ­¢å†…å®¹æº¢å‡º */
            display: flex;
            flex-direction: column;
        }

        /* --- æŠ˜å çŠ¶æ€çš„æ ·å¼ --- */
        .info-panel.minimized {
            max-height: 60px; /* æŠ˜å åçš„é«˜åº¦ */
            padding: 10px 20px;
            background: rgba(20, 25, 40, 0.6); /* æŠ˜å åç¨å¾®é€æ˜ä¸€ç‚¹ */
            width: 200px; /* æŠ˜å åå®½åº¦å˜å° */
        }

        /* æŠ˜å æ—¶éšè—çš„å†…å®¹ */
        .info-panel.minimized .nav-bar,
        .info-panel.minimized .real-photo-container,
        .info-panel.minimized .data-grid,
        .info-panel.minimized #planetDesc,
        .info-panel.minimized .speak-btn,
        .info-panel.minimized .en-name {
            opacity: 0;
            pointer-events: none;
            display: none; /* ç›´æ¥éšè—ä»¥ä¸å ä½ */
        }

        /* æŠ˜å æ—¶æ ‡é¢˜æ ·å¼çš„å¾®è°ƒ */
        .info-panel.minimized h2 {
            font-size: 1.2rem;
            margin: 0;
            line-height: 40px; /* å‚ç›´å±…ä¸­ */
            white-space: nowrap;
        }

        /* --- æŠ˜å /å±•å¼€ åˆ‡æ¢æŒ‰é’® --- */
        .toggle-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: 0.2s;
            z-index: 101;
        }
        .toggle-btn:hover { background: rgba(255,255,255,0.25); transform: scale(1.1); }
        
        /* é’ˆå¯¹ä¸åŒçŠ¶æ€æ”¹å˜æŒ‰é’®ä½ç½®æˆ–å›¾æ ‡ */
        .info-panel.minimized .toggle-btn {
            top: 50%;
            transform: translateY(-50%);
            right: 15px;
            background: #ffd700; /* æŠ˜å æ—¶æŒ‰é’®é«˜äº® */
            color: #000;
            border: none;
        }

        /* --- å†…å®¹åŒºåŸŸæ ·å¼ä¿æŒä¸å˜ --- */
        .nav-bar { display: flex; gap: 12px; overflow-x: auto; padding-bottom: 15px; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); flex-shrink: 0; }
        .nav-icon { width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: 0.2s; flex-shrink: 0; }
        .nav-icon:hover, .nav-icon.active { transform: scale(1.15); border-color: #ffd700; box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); }

        .real-photo-container { width: 100%; height: 200px; border-radius: 12px; overflow: hidden; margin-bottom: 15px; position: relative; background: #000; flex-shrink: 0; }
        .real-photo { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        .photo-tag { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.7); color: #fff; font-size: 0.75rem; padding: 4px 8px; border-radius: 6px; }

        h2 { margin: 0 0 8px 0; color: #ffd700; font-size: 1.8rem; letter-spacing: 1px; flex-shrink: 0; transition: font-size 0.3s; }
        .en-name { font-size: 1rem; color: #aaa; margin-left: 8px; font-weight: normal; }
        
        /* æ»šåŠ¨å†…å®¹åŒº */
        .scroll-content { overflow-y: auto; scrollbar-width: none; padding-right: 5px; }
        .scroll-content::-webkit-scrollbar { display: none; }

        p { font-size: 1rem; line-height: 1.7; color: #e0e0e0; margin: 15px 0; text-align: justify; }
        .data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .data-item { background: rgba(255,255,255,0.08); padding: 8px 12px; border-radius: 8px; font-size: 0.85rem; color: #ddd; display: flex; flex-direction: column; }
        .data-label { color: #888; font-size: 0.75rem; margin-bottom: 2px; }

        .speak-btn { width: 100%; background: linear-gradient(135deg, #ff8c00, #ff4500); border: none; color: white; padding: 12px; border-radius: 30px; cursor: pointer; font-size: 1rem; font-weight: bold; margin-top: 10px; flex-shrink: 0; }

        #loading { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 1.5rem; pointer-events: none; z-index: 999; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>

    <div id="loading">âœ¨ å®‡å®™é£èˆ¹å¯åŠ¨ä¸­...</div>
    <div id="canvas-container"></div>

    <div class="info-panel" id="infoPanel">
        <!-- æŠ˜å /å±•å¼€æŒ‰é’® -->
        <button class="toggle-btn" id="toggleBtn" title="æŠ˜å /å±•å¼€é¢æ¿">â–¼</button>

        <div class="nav-bar" id="navBar"></div>
        
        <h2 id="planetName">å¤ªé˜³ç³» <span class="en-name">Solar System</span></h2>
        
        <!-- å¯æ»šåŠ¨å†…å®¹åŒ…è£¹å±‚ -->
        <div class="scroll-content">
            <div class="real-photo-container">
                <img id="planetPhoto" class="real-photo" src="" alt="è¡Œæ˜Ÿç…§ç‰‡">
                <div class="photo-tag">çœŸå®ç…§ç‰‡</div>
            </div>
            
            <div class="data-grid" id="planetData"></div>
            
            <p id="planetDesc">è¿™é‡Œæ˜¯æµ©ç€šçš„å¤ªé˜³ç³»ï¼å³ä¸Šè§’çš„æŒ‰é’®å¯ä»¥æŠŠè¿™ä¸ªé¢æ¿æ”¶èµ·æ¥å“¦ã€‚æ‹–åŠ¨å±å¹•æ—‹è½¬è§†è§’ï¼Œç‚¹å‡»æ˜Ÿçƒï¼Œå»æ¢ç´¢å®ƒä»¬çš„ç§˜å¯†å§ï¼</p>
            
            <button class="speak-btn" id="speakBtn">ğŸ”Š å¬å¬ä»‹ç»</button>
        </div>
    </div>

    <script>
        // --- 1. é¢æ¿æŠ˜å äº¤äº’é€»è¾‘ ---
        const panel = document.getElementById('infoPanel');
        const toggleBtn = document.getElementById('toggleBtn');
        let isMinimized = false;

        toggleBtn.onclick = function() {
            isMinimized = !isMinimized;
            if (isMinimized) {
                panel.classList.add('minimized');
                toggleBtn.innerHTML = 'â–²'; // å˜æˆå‘ä¸Šç®­å¤´ï¼Œæç¤ºå¯ä»¥å±•å¼€
            } else {
                panel.classList.remove('minimized');
                toggleBtn.innerHTML = 'â–¼'; // å˜æˆå‘ä¸‹ç®­å¤´ï¼Œæç¤ºå¯ä»¥æŠ˜å 
            }
        };

        // --- 2. 3Dä¸æ•°æ®éƒ¨åˆ† (ä¿æŒä¸å˜) ---
        const planetData = [
            {
                key: 'mercury', name: 'æ°´æ˜Ÿ', en: 'Mercury',
                size: 1, distance: 20, speed: 0.04, baseColor: 0xA5A5A5,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/3/30/Mercury_mostly_true_color_MESSENGER_orthographic_projection.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d9/Mercury_in_color_-_Prockter07-edit1.jpg/600px-Mercury_in_color_-_Prockter07-edit1.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '5800ä¸‡å…¬é‡Œ', 'æ¸©åº¦': 'å†°ç«ä¸¤é‡å¤©' },
                desc: 'æˆ‘æ˜¯æ°´æ˜Ÿï¼Œå¤ªé˜³ç³»é‡Œè·‘å¾—æœ€å¿«çš„â€œå°é£æ¯›è…¿â€ï¼å› ä¸ºç¦»å¤ªé˜³å…¬å…¬æœ€è¿‘ï¼Œæ‰€ä»¥æˆ‘èº«ä¸Šæ²¡æœ‰ç©ºæ°”ï¼Œä¹Ÿæ²¡æœ‰æ°´ã€‚ç™½å¤©æˆ‘çƒ­å¾—åƒç«ç‚‰ï¼Œæ™šä¸Šåˆå†·å¾—åƒå†°çª–ã€‚æˆ‘èº«ä¸Šæœ‰å¾ˆå¤šå‘å‘æ´¼æ´¼ï¼Œé•¿å¾—ç‰¹åˆ«åƒä½ ä»¬æ™šä¸Šè§åˆ°çš„æœˆäº®ã€‚'
            },
            {
                key: 'venus', name: 'é‡‘æ˜Ÿ', en: 'Venus',
                size: 1.8, distance: 28, speed: 0.015, baseColor: 0xE3BB76,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/1/1c/Solarsystemscope_texture_2k_venus_surface.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/e/e5/Venus-real_color.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '1.08äº¿å…¬é‡Œ', 'ç‰¹ç‚¹': 'æœ€äº®çš„æ˜Ÿ' },
                desc: 'æˆ‘æ˜¯é‡‘æ˜Ÿï¼Œæ˜¯å¤œç©ºä¸­æœ€äº®çš„æ˜æ˜Ÿï¼Œä¹Ÿå«â€œå¯æ˜æ˜Ÿâ€ã€‚è™½ç„¶æ°´æ˜Ÿç¦»å¤ªé˜³æ›´è¿‘ï¼Œä½†æˆ‘ç©¿ç€åšåšçš„é»„è‰²äº‘å½©å¤§è¡£ï¼Œçƒ­æ°”æ•£ä¸å‡ºå»ï¼Œæ‰€ä»¥æˆ‘æ‰æ˜¯å¤ªé˜³ç³»é‡Œæœ€çƒ­çš„â€œç«ç„°å±±â€ï¼è€Œä¸”ï¼Œæˆ‘æ˜¯å€’ç€è½¬åœˆçš„ï¼Œåœ¨é‡‘æ˜Ÿä¸Šï¼Œå¤ªé˜³æ˜¯ä»è¥¿è¾¹å‡ºæ¥çš„å“¦ã€‚'
            },
            {
                key: 'earth', name: 'åœ°çƒ', en: 'Earth',
                size: 1.9, distance: 38, speed: 0.01, baseColor: 0x22A6B3,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/c/cf/Solarsystemscope_texture_2k_earth_daymap.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/97/The_Earth_seen_from_Apollo_17.jpg/600px-The_Earth_seen_from_Apollo_17.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '1.5äº¿å…¬é‡Œ', 'å®¶å›­': 'å”¯ä¸€çš„ç”Ÿå‘½' },
                desc: 'æˆ‘æ˜¯åœ°çƒï¼Œæ˜¯ä½ ä»¬å”¯ä¸€çš„å®¶å›­ï¼Œä¸€é¢—è“è‰²çš„å®çŸ³ã€‚æˆ‘æœ‰è¾½é˜”çš„æµ·æ´‹ã€ç»¿è‰²çš„æ£®æ—å’Œç™½è‰²çš„äº‘æœµã€‚æˆ‘æ˜¯å¤ªé˜³ç³»é‡Œå”¯ä¸€æœ‰èŠ±è‰æ ‘æœ¨å’Œå°åŠ¨ç‰©å±…ä½çš„åœ°æ–¹ã€‚æˆ‘æœ‰ä¸ªæœˆäº®å¥½æœ‹å‹ï¼Œä¸€ç›´é™ªç€æˆ‘è·³èˆï¼Œå°æœ‹å‹ä»¬ä¸€å®šè¦å¥½å¥½çˆ±æŠ¤æˆ‘å‘€ï¼'
            },
            {
                key: 'mars', name: 'ç«æ˜Ÿ', en: 'Mars',
                size: 1.2, distance: 50, speed: 0.008, baseColor: 0xDD4C22,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/7/70/Solarsystemscope_texture_2k_mars.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/OSIRIS_Mars_true_color.jpg/600px-OSIRIS_Mars_true_color.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '2.28äº¿å…¬é‡Œ', 'é¢œè‰²': 'çº¢è‰²' },
                desc: 'æˆ‘æ˜¯ç«æ˜Ÿï¼Œå¤§å®¶éƒ½å«æˆ‘â€œçº¢è‰²æ˜Ÿçƒâ€ï¼Œå› ä¸ºæˆ‘å…¨èº«é“ºæ»¡äº†çº¢è‰²çš„é“é”ˆæ²™å°˜ã€‚æˆ‘æœ‰å…¨å¤ªé˜³ç³»æœ€é«˜çš„ç«å±±â€”â€”å¥¥æ—å¸•æ–¯å±±ï¼Œæ¯”ç ç©†æœ—ç›å³°é«˜ä¸‰å€å‘¢ï¼ç°åœ¨æœ‰å¥½å¤šäººç±»æ´¾å‡ºçš„å°è½¦è½¦ï¼ˆç«æ˜Ÿè½¦ï¼‰åœ¨æˆ‘èº«ä¸Šæ¢é™©ï¼Œå¯»æ‰¾æ°´çš„è¸ªè¿¹ã€‚'
            },
            {
                key: 'jupiter', name: 'æœ¨æ˜Ÿ', en: 'Jupiter',
                size: 5.5, distance: 75, speed: 0.004, baseColor: 0xD8CA9D,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/e/e4/Jupiter_Hubble_2019_Select.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2b/Jupiter_and_its_shrunken_Great_Red_Spot.jpg/600px-Jupiter_and_its_shrunken_Great_Red_Spot.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '7.78äº¿å…¬é‡Œ', 'å¤§å°': 'æœ€å¤§' },
                desc: 'æˆ‘æ˜¯æœ¨æ˜Ÿï¼Œæ˜¯å¤ªé˜³ç³»é‡Œçš„â€œå·¨äººå¤§å“¥â€ï¼æˆ‘çš„è‚šå­å¤§åˆ°èƒ½è£…ä¸‹1300ä¸ªåœ°çƒã€‚æˆ‘æ˜¯ä¸€é¢—æ°”ä½“å·¨æ˜Ÿï¼Œè¸©ä¸Šå»ä¼šæ‰è¿›å»çš„ã€‚çœ‹åˆ°æˆ‘è‚šå­ä¸Šçš„å¤§çº¢æ–‘äº†å—ï¼Ÿé‚£æ˜¯ä¸€ä¸ªåˆ®äº†å‡ ç™¾å¹´çš„è¶…çº§å¤§é£æš´ã€‚æˆ‘è¿˜åƒå¸å°˜å™¨ä¸€æ ·ï¼Œå¸®åœ°çƒæŒ¡ä½äº†å¥½å¤šæ’è¿‡æ¥çš„é™¨çŸ³å‘¢ã€‚'
            },
            {
                key: 'saturn', name: 'åœŸæ˜Ÿ', en: 'Saturn',
                size: 4.5, distance: 100, speed: 0.003, baseColor: 0xF4D03F, hasRing: true,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/0/03/Solarsystemscope_texture_2k_saturn.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/Saturn_during_Equinox.jpg/640px-Saturn_during_Equinox.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '14äº¿å…¬é‡Œ', 'ç‰¹å¾': 'ç¾ä¸½å…‰ç¯' },
                desc: 'æˆ‘æ˜¯åœŸæ˜Ÿï¼Œæˆ‘æ˜¯å®‡å®™ä¸­æœ€ä¼˜é›…çš„èˆè€…ã€‚æˆ‘ä¹Ÿæœ‰ä¸€ä»¶æ°”ä½“åšçš„è¡£æœï¼Œä½†æˆ‘æœ€è‡ªè±ªçš„æ˜¯è…°é—´é‚£ä¸ªå®½å®½å¤§å¤§çš„å…‰ç¯ï¼Œé‚£æ˜¯æ— æ•°å†°å—å’Œå²©çŸ³ç»„æˆçš„ã€‚è™½ç„¶æˆ‘å¾ˆå¤§ï¼Œä½†æˆ‘å¾ˆè½»ï¼Œå¦‚æœæœ‰ä¸€ä¸ªè¶…çº§å¤§çš„æµ´ç¼¸ï¼Œæˆ‘ç”šè‡³èƒ½æµ®åœ¨æ°´é¢ä¸Šæ´—æ¾¡å‘¢ï¼'
            },
            {
                key: 'uranus', name: 'å¤©ç‹æ˜Ÿ', en: 'Uranus',
                size: 3.0, distance: 125, speed: 0.002, baseColor: 0x73C6B6,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/9/95/Solarsystemscope_texture_2k_uranus.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Uranus2.jpg/600px-Uranus2.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '29äº¿å…¬é‡Œ', 'ç‰¹ç‚¹': 'èººç€è½¬' },
                desc: 'æˆ‘æ˜¯å¤©ç‹æ˜Ÿï¼Œä¸€é¢—æ¼‚äº®çš„è“ç»¿è‰²å†°çƒã€‚æˆ‘å’Œåˆ«çš„æ˜Ÿæ˜Ÿéƒ½ä¸ä¸€æ ·ï¼Œæˆ‘æ˜¯â€œèººç€â€è½¬åœˆçš„ï¼Œå°±åƒåœ¨è½¨é“ä¸Šæ‰“æ»šä¸€æ ·ï¼è¿™ä¹Ÿè®©æˆ‘ç»å†äº†éå¸¸æ¼«é•¿çš„å†¬å¤©å’Œå¤å¤©ã€‚æˆ‘ç¦»å¤ªé˜³å¾ˆè¿œï¼Œè¿™é‡Œéå¸¸éå¸¸å†·ï¼Œè¢«ç§°ä¸ºâ€œå†°å·¨æ˜Ÿâ€ã€‚'
            },
            {
                key: 'neptune', name: 'æµ·ç‹æ˜Ÿ', en: 'Neptune',
                size: 2.9, distance: 150, speed: 0.001, baseColor: 0x5B5DDF,
                texture: 'https://upload.wikimedia.org/wikipedia/commons/1/1e/Solarsystemscope_texture_2k_neptune.jpg',
                photo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/Neptune_-_Voyager_2_%2829347980845%29_flatten_crop.jpg/600px-Neptune_-_Voyager_2_%2829347980845%29_flatten_crop.jpg',
                data: { 'è·ç¦»å¤ªé˜³': '45äº¿å…¬é‡Œ', 'ç‰¹ç‚¹': 'é£é€Ÿæœ€å¿«' },
                desc: 'æˆ‘æ˜¯æµ·ç‹æ˜Ÿï¼Œç¦»å¤ªé˜³æœ€è¿œï¼Œæ‰€ä»¥æˆ‘æ˜¯ç¥ç§˜çš„æ·±è“è‰²ã€‚æˆ‘è¿™é‡Œéå¸¸æš—ï¼Œä¹Ÿéå¸¸å†·ã€‚ä½†æˆ‘ä¹Ÿæ˜¯ä¸ªæš´è„¾æ°”ï¼Œæˆ‘æœ‰å¤ªé˜³ç³»é‡Œæœ€å¿«çš„é£ï¼Œé£é€Ÿå¿«åˆ°èƒ½æŠŠå¤§æ ‘è¿æ ¹æ‹”èµ·ï¼å› ä¸ºè·¯é€”å¤ªè¿œï¼Œæˆ‘ç»•å¤ªé˜³è·‘ä¸€åœˆï¼Œéœ€è¦165å¹´å‘¢ã€‚'
            }
        ];

        // Three.js Setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 80, 140); 

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.maxDistance = 350;

        const ambientLight = new THREE.AmbientLight(0xaaaaaa, 0.8); scene.add(ambientLight);
        const pointLight = new THREE.PointLight(0xffffff, 1.2, 400); scene.add(pointLight);

        // Stars
        const starGeo = new THREE.BufferGeometry();
        const starCount = 6000;
        const starPos = new Float32Array(starCount * 3);
        for(let i=0; i<starCount*3; i++) starPos[i] = (Math.random() - 0.5) * 800;
        starGeo.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
        scene.add(new THREE.Points(starGeo, new THREE.PointsMaterial({color: 0xffffff, size: 0.7})));

        const loader = new THREE.TextureLoader();
        const planetMeshes = [];

        // Sun
        const sunMat = new THREE.MeshBasicMaterial({ map: loader.load('https://upload.wikimedia.org/wikipedia/commons/9/99/Map_of_the_full_sun.jpg'), color: 0xffdd00 });
        const sun = new THREE.Mesh(new THREE.SphereGeometry(10, 32, 32), sunMat);
        scene.add(sun);
        scene.add(new THREE.Mesh(new THREE.SphereGeometry(11, 32, 32), new THREE.MeshBasicMaterial({ color: 0xffaa00, transparent: true, opacity: 0.3, side: THREE.BackSide })));

        // Planets
        planetData.forEach(p => {
            const orbit = new THREE.Mesh(new THREE.RingGeometry(p.distance - 0.3, p.distance + 0.3, 128), new THREE.MeshBasicMaterial({ color: p.baseColor, opacity: 0.3, transparent: true, side: THREE.DoubleSide }));
            orbit.rotation.x = -Math.PI / 2;
            scene.add(orbit);

            const material = new THREE.MeshStandardMaterial({
                map: loader.load(p.texture), color: 0xffffff, roughness: 0.6, emissive: p.baseColor, emissiveIntensity: 0.2
            });
            const mesh = new THREE.Mesh(new THREE.SphereGeometry(p.size, 32, 32), material);
            const startAngle = Math.random() * Math.PI * 2;
            mesh.position.set(Math.cos(startAngle) * p.distance, 0, Math.sin(startAngle) * p.distance);
            scene.add(mesh);

            if (p.hasRing) {
                const ringMat = new THREE.MeshBasicMaterial({ map: loader.load('https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Saturn_ring_texture.jpg/220px-Saturn_ring_texture.jpg'), color: 0xdddddd, side: THREE.DoubleSide, transparent: true, opacity: 0.8 });
                const ring = new THREE.Mesh(new THREE.RingGeometry(p.size * 1.4, p.size * 2.2, 64), ringMat);
                ring.rotation.x = -Math.PI / 2;
                mesh.add(ring);
            }
            planetMeshes.push({ mesh: mesh, data: p, angle: startAngle, distance: p.distance, speed: p.speed });
        });

        document.getElementById('loading').style.display = 'none';

        function animate() {
            requestAnimationFrame(animate);
            sun.rotation.y += 0.004;
            planetMeshes.forEach(obj => {
                obj.angle += obj.speed * 0.2;
                obj.mesh.position.x = Math.cos(obj.angle) * obj.distance;
                obj.mesh.position.z = Math.sin(obj.angle) * obj.distance;
                obj.mesh.rotation.y += 0.02;
            });
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        // UI & Interaction
        const navBar = document.getElementById('navBar');
        planetData.forEach(p => {
            const icon = document.createElement('div');
            icon.className = 'nav-icon';
            icon.style.backgroundColor = '#' + p.baseColor.toString(16);
            icon.style.backgroundImage = `url(${p.texture})`;
            icon.style.backgroundSize = 'cover';
            icon.title = p.name;
            icon.onclick = () => updateInfo(p);
            navBar.appendChild(icon);
        });

        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        
        window.addEventListener('click', (event) => {
            if(event.target.closest('.info-panel')) return;

            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(planetMeshes.map(p => p.mesh));
            if (intersects.length > 0) {
                const target = intersects[0].object;
                const found = planetMeshes.find(p => p.mesh === target || (target.parent && p.mesh === target.parent));
                if (found) {
                    // å¦‚æœé¢æ¿æ˜¯æŠ˜å çš„ï¼Œè‡ªåŠ¨å±•å¼€ä»¥ä¾¿ç”¨æˆ·æŸ¥çœ‹ä¿¡æ¯
                    if (isMinimized) {
                        toggleBtn.click();
                    }
                    updateInfo(found.data);
                }
            }
        });

        const photoEl = document.getElementById('planetPhoto');
        const nameEl = document.getElementById('planetName');
        const dataEl = document.getElementById('planetData');
        const descEl = document.getElementById('planetDesc');
        const speakBtn = document.getElementById('speakBtn');
        let synth = window.speechSynthesis;
        let isSpeaking = false;

        photoEl.src = "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/The_Sun_by_the_Atmospheric_Imaging_Assembly_of_NASA%27s_Solar_Dynamics_Observatory_-_20100819.jpg/600px-The_Sun_by_the_Atmospheric_Imaging_Assembly_of_NASA%27s_Solar_Dynamics_Observatory_-_20100819.jpg";

        function updateInfo(data) {
            stopSpeech();
            photoEl.style.opacity = 0;
            setTimeout(() => {
                photoEl.src = data.photo;
                photoEl.onload = () => photoEl.style.opacity = 1;
            }, 200);
            nameEl.innerHTML = `${data.name} <span class="en-name">${data.en}</span>`;
            dataEl.innerHTML = Object.entries(data.data).map(([k,v]) => `<div class="data-item"><span class="data-label">${k}</span><span>${v}</span></div>`).join('');
            descEl.innerText = data.desc;
            
            document.querySelectorAll('.nav-icon').forEach(i => i.classList.remove('active'));
            const idx = planetData.indexOf(data);
            if(document.querySelectorAll('.nav-icon')[idx]) document.querySelectorAll('.nav-icon')[idx].classList.add('active');

            speakBtn.innerHTML = 'ğŸ”Š å¬å¬ä»‹ç»';
            speakBtn.onclick = () => toggleSpeech(data.desc);
        }

        function toggleSpeech(text) {
            if (isSpeaking) {
                stopSpeech();
            } else {
                stopSpeech();
                const u = new SpeechSynthesisUtterance(text);
                u.lang = 'zh-CN'; u.rate = 0.95; u.pitch = 1.05;
                u.onend = () => { isSpeaking = false; speakBtn.innerHTML = 'ğŸ”Š å¬å¬ä»‹ç»'; };
                synth.speak(u);
                isSpeaking = true;
                speakBtn.innerHTML = 'â¸ï¸ æš‚åœæœ—è¯»';
            }
        }
        function stopSpeech() {
            if (synth.speaking || synth.pending) synth.cancel();
            isSpeaking = false;
            speakBtn.innerHTML = 'ğŸ”Š å¬å¬ä»‹ç»';
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>